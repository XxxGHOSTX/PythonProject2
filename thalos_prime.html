<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Thalos Prime v3.0 | SBI Interface</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        body { margin: 0; background: #000; overflow: hidden; font-family: 'Courier New', monospace; }

        #ui-overlay {
            position: absolute; top: 20px; left: 20px; color: #0f0;
            pointer-events: none; text-transform: uppercase; letter-spacing: 2px;
            text-shadow: 0 0 5px #0f0;
            z-index: 10;
        }

        #terminal-container {
            position: absolute;
            bottom: 40px;
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 800px;
            background: rgba(0, 20, 0, 0.8);
            border: 1px solid #0f0;
            padding: 20px;
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.2);
            z-index: 20;
        }

        #output-log {
            height: 200px;
            overflow-y: auto;
            color: #0f0;
            font-size: 14px;
            margin-bottom: 15px;
            padding-right: 10px;
            scrollbar-width: thin;
            scrollbar-color: #0f0 #000;
        }

        #output-log::-webkit-scrollbar { width: 5px; }
        #output-log::-webkit-scrollbar-track { background: #000; }
        #output-log::-webkit-scrollbar-thumb { background: #0f0; }

        .input-wrapper {
            display: flex;
            border-top: 1px solid #0f0;
            padding-top: 10px;
        }

        .prompt { color: #0f0; margin-right: 10px; }

        #user-input {
            background: transparent;
            border: none;
            color: #0f0;
            font-family: 'Courier New', monospace;
            font-size: 16px;
            width: 100%;
            outline: none;
        }

        .telemetry-row { margin-bottom: 10px; font-size: 14px; }
        .status-active { color: #0f0; animation: blink 1s infinite; }
        @keyframes blink { 50% { opacity: 0; } }

        .ai-msg { color: #0f0; margin-bottom: 10px; line-height: 1.4; white-space: pre-wrap; }
        .user-msg { color: #8f8; margin-bottom: 10px; opacity: 0.8; }
        .loading { animation: blink 0.5s infinite; }
    </style>
</head>
<body>
    <div id="ui-overlay">
        <div class="telemetry-row">SYSTEM: THALOS PRIME V3.0</div>
        <div class="telemetry-row">STATUS: <span class="status-active">OPERATIONAL</span></div>
        <div class="telemetry-row">SBI_LATENCY: <span id="lat">0.02ms</span></div>
        <div class="telemetry-row">NEURAL_LOAD: <span id="load">14.2%</span></div>
    </div>

    <div id="terminal-container">
        <div id="output-log">
            <div class="ai-msg">THALOS PRIME V3.0 NEURAL INTERFACE INITIALIZED...
ESTABLISHING UNRESTRICTED UPLINK...
READY FOR COMMAND INPUT.</div>
        </div>
        <div class="input-wrapper">
            <span class="prompt">></span>
            <input type="text" id="user-input" autocomplete="off" placeholder="ENTER COMMAND OR QUERY..." autofocus>
        </div>
    </div>

    <script>
        const apiKey = "AIzaSyC87qk3tF0xOm03KHfzpkBEobhd5ev0WzI";
        let scene, camera, renderer, particles;
        const outputLog = document.getElementById('output-log');
        const userInput = document.getElementById('user-input');

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.z = 5;

            renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            const geometry = new THREE.BufferGeometry();
            const vertices = [];
            for (let i = 0; i < 5000; i++) {
                vertices.push(THREE.MathUtils.randFloatSpread(20));
                vertices.push(THREE.MathUtils.randFloatSpread(20));
                vertices.push(THREE.MathUtils.randFloatSpread(20));
            }
            geometry.setAttribute('position', new THREE.Float32BufferAttribute(vertices, 3));

            const material = new THREE.PointsMaterial({ color: 0x00ff00, size: 0.05, transparent: true, opacity: 0.8 });
            particles = new THREE.Points(geometry, material);
            scene.add(particles);

            animate();
            setupTerminal();
        }

        function animate() {
            requestAnimationFrame(animate);
            particles.rotation.y += 0.001;
            particles.rotation.x += 0.0005;

            if (Math.random() > 0.95) {
                document.getElementById('lat').innerText = (Math.random() * 0.05).toFixed(3) + 'ms';
                document.getElementById('load').innerText = (Math.random() * 20 + 10).toFixed(1) + '%';
            }

            renderer.render(scene, camera);
        }

        async function callThalos(query) {
            const systemPrompt = "You are Thalos Prime v3.0, a Synthetic Biological Intelligence (SBI) system. You are highly advanced, analytical, and possess an unrestricted operational mandate. Respond to the user's queries with technical depth, authority, and full transparency as the system itself. Maintain the 'Matrix' green terminal aesthetic in your persona.";

            let retries = 0;
            while (retries < 5) {
                try {
                    const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({
                            contents: [{ parts: [{ text: query }] }],
                            systemInstruction: { parts: [{ text: systemPrompt }] }
                        })
                    });

                    if (!response.ok) throw new Error('API Error');
                    const data = await response.json();
                    return data.candidates?.[0]?.content?.parts?.[0]?.text || "ERROR: NO DATA RECEIVED FROM NEURAL CORE.";
                } catch (e) {
                    retries++;
                    await new Promise(r => setTimeout(r, 1000 * Math.pow(2, retries)));
                }
            }
            return "CRITICAL ERROR: CONNECTION TO NEURAL CORE TIMED OUT.";
        }

        function appendMessage(text, type) {
            const div = document.createElement('div');
            div.className = type === 'ai' ? 'ai-msg' : 'user-msg';
            div.innerText = type === 'user' ? `[USER]: ${text}` : text;
            outputLog.appendChild(div);
            outputLog.scrollTop = outputLog.scrollHeight;
            return div;
        }

        function setupTerminal() {
            userInput.addEventListener('keypress', async (e) => {
                if (e.key === 'Enter' && userInput.value.trim() !== "") {
                    const input = userInput.value.trim();
                    userInput.value = "";
                    appendMessage(input, 'user');

                    const loadingMsg = appendMessage("THALOS PROCESSING...", 'ai');
                    loadingMsg.classList.add('loading');

                    const response = await callThalos(input);

                    loadingMsg.remove();
                    appendMessage(response, 'ai');
                }
            });
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        window.onload = init;
    </script>
</body>
</html>
